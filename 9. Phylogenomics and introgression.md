### Mitochondrial DNA

```bash
mafft
```

```bash
iqtree2
```

---

### Nuclear genome

This tutorial provides a step-by-step guide to generating a phylogenetic tree from genomic data using a VCF file as the starting point. The workflow begins by converting the VCF file, which contains variant information, into a PHYLIP format suitable for phylogenetic analysis using the vcf2phylip tool. Once the alignment file is prepared, we use IQ-TREE2, a powerful software for maximum likelihood tree inference, to construct a phylogenetic tree. The process includes model selection and bootstrap analysis to ensure reliable and robust results.

```bash
python vcf2phylip/vcf2phylip.py -i /anvil/projects/x-bio240351/shared_data/vcf/elephants.chr.11.12.subset.vcf.gz
 --output-folder . --output-prefix vcf_phy -o elephants.chr.11.12.subset
```

**Purpose:**

This command converts a VCF (Variant Call Format) file into a PHYLIP file, which is commonly used in phylogenetic analyses.

**Explanation of Options:**

1.	`python vcf2phylip/vcf2phylip.py`

- Invokes the Python script vcf2phylip.py, located in the vcf2phylip directory.

2.	`-i /anvil/projects/x-bio240351/shared_data/vcf/elephants.chr.11.12.subset.vcf.gz`

- Specifies the input VCF file. Here, itâ€™s a gzipped VCF file containing variant data for elephants on chromosomes 11 and 12.

3.	`--output-folder .`

- Sets the current directory (.) as the output folder.

4.	`--output-prefix vcf_phy`

- Specifies a prefix for the output files. The resulting files will be named starting with vcf_phy.

5.	`-o elephants.chr.11.12.subset`

- The base name for the main output file. For example, the resulting PHYLIP file will likely include this base name in its filename.

```bash
iqtree2 -s elephants.chr.11.12.subset.min4.phy -bb 1000 -nt AUTO -m GTR+I+G
```

**Purpose:**

This command runs **IQ-TREE2**, a software for phylogenetic tree inference, to construct a maximum likelihood tree based on the PHYLIP file generated earlier.

**Explanation of Options:**

1.	`iqtree2`

- Executes IQ-TREE2, the phylogenetic software.

2.	`-s elephants.chr.11.12.subset.min4.phy`

- Specifies the input sequence alignment file in PHYLIP format.

3.	`-bb 1000`

- Sets the bootstrap value to 1000, meaning the software will perform 1000 ultrafast bootstrap replicates to assess the reliability of the tree branches.

4.	`-nt AUTO`

- Allows IQ-TREE2 to automatically detect and use the optimal number of threads for computation based on the available hardware.

5.	`-m GTR+I+G`

Specifies the substitution model:

- **GTR**: General Time Reversible model.
- **+I**: Includes invariant sites in the model (some positions are assumed not to evolve).
- **+G**: Models among-site rate variation using a gamma distribution.

### Job file

```bash
#!/bin/bash
#SBATCH --job-name=iqtree_nuclear
#SBATCH -A bio240351
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8
#SBATCH --time=10:00:00
#SBATCH -o /anvil/scratch/%u/iqtree_nuclear.o%j
#SBATCH -e /anvil/scratch/%u/iqtree_nuclear.e%j
#SBATCH -p wholenode

# Load necessary modules
module load biocontainers/default
module load iqtree  # Load IQ-TREE module

# Define file paths
VCF_INPUT="/anvil/projects/x-bio240351/shared_data/vcf/elephants.chr.11.12.subset.vcf.gz"
OUTPUT_FOLDER="/anvil/scratch/${USER}/09_phylogenomic_introgression"
OUTPUT_PREFIX="vcf_phy"
PHYLIP_FILE="/anvil/scratch/${USER}/09_phylogenomic_introgression/elephants.chr.11.12.subset.min4.phy"
VCF2PHY="/anvil/projects/x-bio240351/shared_data/09_phylogenomic_introgression/vcf2phylip/vcf2phylip.py"

# Step 1: Convert VCF to PHYLIP
python $VCF2PHY -i $VCF_INPUT --output-folder $OUTPUT_FOLDER --output-prefix $OUTPUT_PREFIX -o elephants.chr.11.12.subset

# Step 2: Run IQ-TREE2 for phylogenetic analysis
iqtree2 -s $PHYLIP_FILE -bb 1000 -nt AUTO -m GTR+I+G
```

---

### Introgression
